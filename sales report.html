<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="theme-color" content="#000000">
    <meta name="name" content="PyScript/Panel KMeans Demo">

    <title>Sales Report 2021-2020</title>
    <!-- <link rel="icon" type="image/x-icon" href="./favicon.png"> -->

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" type="text/css" />
    <link rel="stylesheet" href="https://unpkg.com/@holoviz/panel@0.13.1/dist/css/widgets.css" type="text/css" />
    <link rel="stylesheet" href="https://unpkg.com/@holoviz/panel@0.13.1/dist/css/markdown.css" type="text/css" />

    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/vega@5.22.1"></script>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/vega-lite@5.5.0"></script>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/vega-embed@6.21.0"></script>
    <script type="text/javascript" src="https://unpkg.com/tabulator-tables@4.9.3/dist/js/tabulator.js"></script>
    <script type="text/javascript" src="https://cdn.bokeh.org/bokeh/release/bokeh-2.4.3.js"></script>
    <script type="text/javascript" src="https://cdn.bokeh.org/bokeh/release/bokeh-widgets-2.4.3.min.js"></script>
    <script type="text/javascript" src="https://cdn.bokeh.org/bokeh/release/bokeh-tables-2.4.3.min.js"></script>
    <script type="text/javascript" src="https://unpkg.com/@holoviz/panel@0.13.1/dist/panel.min.js"></script>
    <script type="text/javascript">
      Bokeh.set_log_level("info");
    </script>

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://unpkg.com/@holoviz/panel@0.13.1/dist/bundled/bootstraptemplate/bootstrap.css">
    <link rel="stylesheet" href="https://unpkg.com/@holoviz/panel@0.13.1/dist/bundled/defaulttheme/default.css">
    <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
    <link rel="stylesheet" href="https://www.w3schools.com/lib/w3-theme-black.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

    <style>
      #sidebar {
	  width: 350px;
      }
      .w3-sidebar {
    z-index: 3;
    width: 250px;
    top: 43px;
    bottom: 0;
    height: inherit; }

    </style>

    <script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js"></script>

    <link rel="stylesheet" href="https://pyscript.net/latest/pyscript.css" />
    <script defer src="https://pyscript.net/latest/pyscript.js"></script>
  </head>

  <py-env>
    - altair
    - numpy
    - pandas
    - scikit-learn
    - panel==0.13.1
    - matplotlib
  </py-env>

  <body>

    <div class="container-fluid d-flex flex-column vh-100 overflow-hidden" id="container">
      <!-- Side Navigation and Header -->
      <nav class="navbar navbar-expand-md navbar-dark sticky-top shadow w3-blue-grey" id="header">
	<button type="button" class="navbar-toggle collapsed" id="sidebarCollapse">
	  <span class="navbar-toggler-icon"></span>
	</button>
	<div class="app-header">
	  <a class="w3-xlarge navbar-brand app-logo" href="/">
	    <img src="Pro_health.png" class="app-logo" width = "100" height = "3000">
	  </a>
	  <a class="title" href="" style="color: #efebe3;">Report Analysis</a>
      </div>
      </nav>


      <div class="row overflow-hidden" id="content">
	<div class="sidenav" id="sidebar">
    <h5 class="w3-text-teal">Select The Variable "X" and "Y":</h5>
	  <ul class="nav flex-column">
            <div class="bk-root" id="x-widget"></div>
            <div class="bk-root" id="button-widget"></div>
            <div class="bk-root" id="y-widget"></div>
            <h5 class="w3-text-teal">Select Number of Clusters:</h5>
            <div class="bk-root" id="n-widget"></div>
            <h5 class="w3-text-teal">Background: Elbow Method to Choose the Optimal <br> Number of K-Means Cluster</h5>
            <!-- <div width: 100px;
            height: 100px; id="line-plot"></div> -->
            <span style="padding-left:20px"><div class="w3-padding-32">
              <button class="w3-btn w3-dark-grey w3-hover-light-grey" onclick="document.getElementById('id01').style.display='block'" style="font-weight:600;">Click here for Description</button>
            </div></span>
	  </ul>
	</div>

  <!-- button -->
  <div id="id01" class="w3-modal">
    <div class="w3-modal-content w3-card-4 w3-animate-top">
      <header class="w3-container w3-theme-l1"> 
        <span onclick="document.getElementById('id01').style.display='none'"
        class="w3-button w3-display-topright">×</span>
        <p> How to Find Optimal Number of Clusters? </p>
      </header>
      <div class="w3-padding">
        <p>In this case y is the Sum of squared distance and x is the K. <br>
          To find the optimal number of cluster we implemented the Elbow method,<br>
          and it has been found that 4 is the most optimal number of clusters.<br>
          However to ensure interactivity we added some slider so that user can choose the number of clusters.</p>
          <img src="https://github.com/FIT3164-MDS8/publish_web/blob/main/ElbowMethod.png?raw=true" alt="Elbow Method for K-Means Clustering" width="100%">
      </div>
      <footer class="w3-container w3-theme-l1">

      </footer>
    </div>
  </div>

  

	<div class="col mh-100 float-left w3-display-container" id="main">

    <!-- Header -->
  <div class="w3-container" style="margin-top:15px" id="showcase">
    <h2 class="w3-xxxlarge"><b>Annual Report on Sales</b></h2>
    <h1 class="w3-xxlarge w3-text-teal"><b>Based on dataset from 2021-2022.</b></h1>
  </div>

      <header style="font-size:30px; margin-top:25px;" class="w3-container w3-blue-grey w3-padding-small">
        <h2>Introduction</h2>
      </header>
	  <p style="margin-top:10px"> Users tend to prefer articles which are easier to find the information they are looking 
      for. However, not all articles display their information in an easy to locate places. Some articles place their information in 
      strategic places such as abstract, keywords, or introduction. <br>
      This project intends to cluster text documents 
      and analyze their similarities/characteristics based on the placement of texts (eg: title words) within the 
      articles. This in case the "X" symbol is the cluster's centroid, which represents the mean of the clusters.</p>
  

    <div class="w3-padding-32 w3-center">
      <button class="w3-btn w3-dark-grey w3-hover-light-grey" onclick="document.getElementById('id02').style.display='block'" style="font-weight:600;">Our Learning Objectives</button>
      <button class="w3-btn w3-dark-grey w3-hover-light-grey" onclick="document.getElementById('id03').style.display='block'" style="font-weight:600;">About the Articles</button>
      <button class="w3-btn w3-dark-grey w3-hover-light-grey" onclick="document.getElementById('id04').style.display='block'" style="font-weight:600;">Software Components</button>
    </div></span>

    <!-- button Learning Objectives -->
  <div id="id02" class="w3-modal">
    <div class="w3-modal-content w3-card-4 w3-animate-top">
      <header class="w3-container w3-theme-l1"> 
        <span onclick="document.getElementById('id02').style.display='none'"
        class="w3-button w3-display-topright">×</span>
        <p> OUR LEARNING OBJECTIVES </p>
      </header>
      <div class="w3-padding">
        <p>1. To perform clustering on text documents.<br>
          2. To analyze these clusters if they showcase some form of similarities in their findability 
          characteristics.<br>
          </p>
      </div>
    </div>
  </div>

    <!-- button About the Articles -->
    <div id="id03" class="w3-modal">
      <div class="w3-modal-content w3-card-4 w3-animate-top">
        <header class="w3-container w3-theme-l1"> 
          <span onclick="document.getElementById('id03').style.display='none'"
          class="w3-button w3-display-topright">×</span>
          <p> ABOUT THE ARTICLES </p>
        </header>
        <div class="w3-padding">
          <p>We are using Article from <i>plos.org</i>, specifically the Plos One, which consist of Research Article, Clinical Trial, 
            Registered Report Protocol, Registered Report, Lab Protocol, and Study protocol. <br>
            We choose <i>Plos One</i> for our cluster model since it has a complete format of article, compared to the other Journal. <br>
            Plos One is a journal community that has a purpose to benefit the society for now and the future by working collaboratively to advance science. It aims to speeds up the advancement 
            of science to be published and discoverable, and freely accessible to all readers. <br>
          </p>
        </div>
      </div>
    </div>

      <!-- button Software Components -->
  <div id="id04" class="w3-modal">
    <div class="w3-modal-content w3-card-4 w3-animate-top">
      <header class="w3-container w3-theme-l1"> 
        <span onclick="document.getElementById('id04').style.display='none'"
        class="w3-button w3-display-topright">×</span>
        <p> OUR SOFTWARE COMPONENTS </p>
      </header>
      <div class="w3-padding">
        <p>The components we are using to build this project are:<br>
          <b>Python Programming Language:</b> This is used during the data pre-process and extraction, and  clustering process<br>
          <b>HTML:</b> This is to build the UI Visualization by structuring web page and our project content, supported by CSS and 
          Javascript to create interactivity. <br>
        </p>
      </div>
    </div>
  </div>
    

    <header style="font-size:30px;" class="w3-container w3-blue-grey w3-padding-small">
      <h2>Clustering on Text Documents</h2>
    </header>
	  <div class="bk-root" style="margin-top:10px" id="cluster-plot" ></div>
  

    <div class="w3-padding w3-display-container w3-white">
      <p >As the value appears on the bottom left-hand-side, it means that particular keywords are difficult to find within the Article’s 
        section, which are Abstract, Introduction, Method, Experiments, Results, and Conclusion. </p>
      <p> On the other side, as the value appears on the upper right-hand-side, it means particular keywords are easy to find within 
        a particular article’s section. </p> 
        <p>
          Hence, when its findability is difficult, the article tends to be not relevant to the keyword that user usually search for query. On the hand, when findability of the keywords within the 
          articles is relatively easy, this means the articles is relevant for the users. 
        </p><br>
    </div>

    <header style="font-size:30px;" class="w3-container w3-blue-grey w3-padding-small">
      <h2>Analysis of Clustering by using Bar Chart</h2>
    </header>
	  <div class="bk-root" style="margin-top:10px" id="bar-plot"></div>
    <div class="bk-root" style="margin-top:10px" id="line-plot"></div>
  
    <div class="w3-padding w3-display-container w3-white">
      <p> Note: The number above the "Section" refer to the Number of Cluster</p>
      <p >This bar graph represents the Average Keywords for each Articles Section depending on the number of K Means Cluster. </p>
      <p> This bar graph interprets that the higher the value of the Average Keywords, the easier the keywords could be find within the article for each of the Article's sections. </p> <br>
    </div>
    
    <div class="w3-container w3-blue-grey w3-padding-small" style="font-size:30px" id="table_des"></div>
	  <div class="bk-root" style="margin-top:10px" id="table"></div>
	</div>
      </div>
    </div>

    

    <py-script>
      import warnings
      import altair as alt
      import panel as pn
      import pandas as pd
      import sklearn.cluster as KMeans
      pn.extension()

      from sklearn.cluster import KMeans
      from pyodide.http import open_url

      warnings.simplefilter(action='ignore', category=FutureWarning)
      pn.config.sizing_mode = 'stretch_width'

      url = 'https://raw.githubusercontent.com/karelchandra/Intern/main/group_month_ps.csv'
      Ax_set = pd.read_csv(open_url(url))

      button = pn.widgets.Button(name='Most Sales', button_type='primary').servable(target='button-widget')
      bar = pn.pane.Vega().servable(target='bar-plot')
      table = pn.widgets.Tabulator(pagination='remote', page_size=10).servable(target='table')
      line = pn.pane.Vega().servable(target='line-plot')
      
      table_des = pn.pane.Markdown("""
      This is the dataset
      """).servable(target='table_des')
      selection = alt.selection_multi(fields=['PS'], bind='legend')
      
      def get_bar_value(df):
        Ax_copy = df.copy()
        Ax_copy['tgl'] = pd.to_datetime(Ax_copy['tgl'])
        Ax_set_m = Ax_copy.groupby([Ax_copy['tgl'].dt.to_period('M'), Ax_copy['PS']])['Value'].sum()
        Ax_set_m = Ax_set_m.reset_index()     
        Ax_set_m['tgl'] = Ax_set_m['tgl'].dt.to_timestamp('s').dt.strftime('%Y-%m')
          return(
            alt.Chart(Ax_set_m)
            .mark_bar()
            .encode(
              y='Value',
              color= alt.Color('PS', legend=alt.Legend(symbolLimit=90),sort='-y'),
              x='tgl',
              tooltip=[alt.Tooltip('Value',format=",.2f"), 'PS']
            )
            .properties(
              height=400, width=500
            )
            .add_selection(
              selection
            )
            .transform_filter(
              selection
            )
          )

      bar.object = get_bar_value(Ax_set)
      table.value=mds
      

      
    </py-script>

    <script>
      $(document).ready(function () {
        $('#sidebarCollapse').on('click', function () {
        $('#sidebar').toggleClass('active')
        $(this).toggleClass('active')
        var interval = setInterval(function () { window.dispatchEvent(new Event('resize')); }, 10);
          setTimeout(function () { clearInterval(interval) }, 210)
        });
      });
    </script>
  </body>
  
</html>
